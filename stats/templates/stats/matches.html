{% extends 'stats/base.html' %}
{% block content %}

<!-- (si ya tienes el formulario de filtros, déjalo tal cual arriba) -->

<section class="games">
  {% for g in games %}
    <article class="game-card res-{{ g.result }}" data-toggle-row aria-expanded="false">
      <div class="game-left">
        <div class="game-jornada">J{{ g.jornada }}</div>
        <div class="game-date">{{ g.date|date:"d-M-y" }}</div>

      </div>

      <div class="game-mid">
        <div class="opponent">
          {% if g.opponent.logo %}
            <img src="{{ g.opponent.logo.url }}" alt="{{ g.opponent.name }}" class="badge-lg">
          {% endif %}
          <div class="opponent-names">
            <div class="club">
                      {{ SITE.site_name|default:HOME_TEAM.name|default:"Pescara" }} <span class="vs">VS</span> {{ g.opponent.name }}
                {% if g.opponent_position %}
                    <span class="opp-rank">(#{{ g.opponent_position }})</span>
                {% endif %}
         </div>
          </div>
        </div>
      </div>

      <div class="game-right">
        <a class="score" href="{% url 'match_detail' g.pk %}">
          {{ g.goals_for }} - {{ g.goals_against }}
        </a>
        <div class="res-tag">
          {% if g.result == 'W' %}Victoria{% elif g.result == 'D' %}Empate{% else %}Derrota{% endif %}
        </div>
      </div>
    </article>

    {# SÁNDWICH detalle asistentes/goles #}
    <div class="detail-row">
      <div class="detail-card">
        <div class="detail-title">Asistencias y goles</div>
        <ul class="detail-list">
          {% for a in g.appearances.all %}
            <li class="{% if a.goals > 0 %}scored{% endif %}">
              <span class="muted">#{{ a.player.number }}</span>
              <span class="opponent">{{ a.player.short_name }}</span>
              <span class="date">Goles</span>
              <span class="goals">{{ a.goals }}</span>
            </li>
          {% empty %}
            <li class="muted">Sin registros de asistentes</li>
          {% endfor %}
        </ul>
      </div>
    </div>
  {% empty %}
    <p class="muted">Sin partidos.</p>
  {% endfor %}
</section>

{% endblock %}